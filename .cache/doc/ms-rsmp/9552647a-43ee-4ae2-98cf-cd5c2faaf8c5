<div class="content"><p>The GetNtmsMediaPoolNameW method retrieves the full name
hierarchy of a media pool, with strings encoded using Unicode.</p><dl>
<dd>
<div><pre> HRESULT GetNtmsMediaPoolNameW(
   [in] LPNTMS_GUID lpPoolId,
   [out, size_is(*lpdwNameSizeBuf), length_is(*lpdwNameSizeBuf)] 
     wchar_t* lpBufName,
   [in] DWORD* lpdwNameSizeBuf,
   [out] DWORD* lpdwNameSize
 );
</pre></div>
</dd></dl><p><b>lpPoolId: </b>A pointer to the identifier of the
media pool for which to retrieve the name. </p><p><b>lpBufName: </b>A null-terminated buffer that contains
the name of the media pool.</p><p><b>lpdwNameSizeBuf: </b>A pointer to the size, in
bytes, of the client buffer that is <a href="8d988f06-72be-47cf-9e09-9060aa8ed897#gt_0e546e86-71c4-45cc-9ef1-4a78f6cb425a" data-linktype="relative-path">allocated</a> to store <i>lpBufName</i>.</p><p><b>lpdwNameSize: </b>A pointer to the length of the
string in <i>lpBufName</i>, including the terminating null character.</p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Return value/code</p>
   </th>
   <th>
   <p>Description</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>0x00000000</p>
  <p>S_OK</p>
  </td>
  <td>
  <p>The call was successful.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070005</p>
  <p>ERROR_ACCESS_DENIED</p>
  </td>
  <td>
  <p>Access to an object was denied. </p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070008</p>
  <p>ERROR_NOT_ENOUGH_MEMORY</p>
  </td>
  <td>
  <p>An allocation error occurred during processing.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070057</p>
  <p>ERROR_INVALID_PARAMETER</p>
  </td>
  <td>
  <p>A parameter is missing or invalid.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x8007007A</p>
  <p>ERROR_INSUFFICIENT_BUFFER</p>
  </td>
  <td>
  <p>The buffer is not large enough. The required size is
  returned in <i>lpdwNameSize</i>.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x800710CE</p>
  <p>ERROR_INVALID_MEDIA_POOL</p>
  </td>
  <td>
  <p>The media pool identifier is missing or invalid.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p>Upon receiving this message, the server MUST verify that <i>lpPoolName</i>,
<i>lpdwNameSize</i>, and <i>lpBufName</i> are not NULL. If parameter validation
fails, the server MUST immediately fail the operation and return ERROR_INVALID_PARAMETER
(0x80070057).</p><p>If parameter validation succeeds, the server MUST verify
that the user has the required access rights, retrieve the name hierarchy for
the given media pool, and return it to the caller in the <i>lpBufferName</i>
buffer. If the client does not have the required access rights, the server MUST
return ERROR_ACCESS_DENIED (0x80070005).</p><p>Strings sent to this method as parameters MUST be
Unicode-encoded.</p></div>