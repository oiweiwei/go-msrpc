<div class="content"><p>The GetNtmsRequestOrder method retrieves the order in which
a request will be processed in the library queue.</p><dl>
<dd>
<div><pre> HRESULT GetNtmsRequestOrder(
   [in] LPNTMS_GUID lpRequestId,
   [out] DWORD* lpdwOrderNumber
 );
</pre></div>
</dd></dl><p><b>lpRequestId: </b>A pointer to the identifier of a <a href="8d988f06-72be-47cf-9e09-9060aa8ed897#gt_f8da5142-cddf-49b1-b24c-a352db74cbbb" data-linktype="relative-path">library request</a>.</p><p><b>lpdwOrderNumber: </b> A pointer to the order in
the queue in which the request will be processed. This queue MUST start with
order 1.</p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Return value/code</p>
   </th>
   <th>
   <p>Description</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>0x00000000</p>
  <p>S_OK</p>
  </td>
  <td>
  <p>The call was successful.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070005</p>
  <p>ERROR_ACCESS_DENIED</p>
  </td>
  <td>
  <p>NTMS_MODIFY_ACCESS to the library is denied; other
  security errors are possible but indicate a security subsystem error.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070008</p>
  <p>ERROR_NOT_ENOUGH_MEMORY</p>
  </td>
  <td>
  <p>An allocation failure occurred during processing.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070057</p>
  <p>ERROR_INVALID_PARAMETER</p>
  </td>
  <td>
  <p>The library identifier is missing.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x800710D9</p>
  <p>ERROR_DATABASE_FAILURE</p>
  </td>
  <td>
  <p>The database is inaccessible or damaged.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p>Upon receiving this message, the server MUST verify that
both <i>lpRequestId</i> and <i>lpdwOrderNumber</i> are not NULL. If parameter
validation fails, the server MUST immediately fail the operation and return
ERROR_INVALID_PARAMETER (0x80070057).</p><p>The server MUST search the request queue for the request ID
that is pointed to by <i>lpRequestId</i>. If the server finds the entry for <i>lpRequestId</i>,
it MUST return the order of that entry in <i>lpdwOrderNumber</i>; otherwise, it
MUST return 0 in <i>lpdwOrderNumber</i>.</p></div>