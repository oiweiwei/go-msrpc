<div class="content"><p>The <b>RMprAdminServerGetInfo</b> method retrieves <a href="fc2dfae9-0d04-4e1d-97c9-c51c2dc06c3b#gt_ac027425-6043-4ad3-be27-56a381b75d38" data-linktype="relative-path">port</a>-related configuration
information for the specified RRAS server using the handle <i>hDimServer</i>.
The <i>dwLevel</i> defines the type of information requested. The caller MUST
pass a pointer to a valid <a href="95609dbb-56aa-4b1b-a0e2-697864a141bd" data-linktype="relative-path"><b>DIM_INFORMATION_CONTAINER (section 2.2.1.2.1)</b></a>.
The caller SHOULD free the memory pointed to by <i>pInfoStruct</i>. </p><dl>
<dd>
<div><pre> DWORD RMprAdminServerGetInfo(
   [in] DIM_HANDLE hDimServer,
   [in] DWORD dwLevel,
   [out] PDIM_INFORMATION_CONTAINER pInfoStruct
 );
</pre></div>
</dd></dl><p><b>hDimServer: </b>A handle to the RRASM server where
the call is executed, see section <a href="1f8cdbcc-9791-4a35-ad78-878b8d110e15" data-linktype="relative-path">3.1.3</a>.</p><p><b>dwLevel: </b>This is of type <b>DWORD</b> and MUST
be set to one of the following values.</p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Value</p>
   </th>
   <th>
   <p>Meaning</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>0</p>
  </td>
  <td>
  <p>After the method returns, the memory pointed by <b>pInfoStruct</b>-&gt;<b>pBuffer</b>
  is interpreted as MPR_SERVER_0 (section <a href="5d243bef-8203-46ea-970a-962590f56200" data-linktype="relative-path">2.2.1.2.61</a>).</p>
  </td>
 </tr><tr>
  <td>
  <p>1</p>
  </td>
  <td>
  <p>After the method returns, the memory pointed by <b>pInfoStruct</b>-&gt;<b>pBuffer</b>
  is interpreted as MPR_SERVER_1 (section <a href="12ffcd88-5613-4ccb-ba5c-c281aec368cb" data-linktype="relative-path">2.2.1.2.62</a>).<a id="Appendix_A_Target_249"></a><a aria-label="Product behavior note 249" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_249" data-linktype="relative-path">&lt;249&gt;</a></p>
  </td>
 </tr><tr>
  <td>
  <p>2</p>
  </td>
  <td>
  <p>After the method returns, the memory pointed by <b>pInfoStruct</b>-&gt;<b>pBuffer</b>
  is interpreted as <a href="7f9bfc09-26be-42e8-83d0-fe4ebf384abe" data-linktype="relative-path">MPR_SERVER_2 (section 2.2.1.2.63)</a>.<a id="Appendix_A_Target_250"></a><a aria-label="Product behavior note 250" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_250" data-linktype="relative-path">&lt;250&gt;</a></p>
  </td>
 </tr></tbody></table>
</dd></dl><p><b>pInfoStruct: </b>This is a pointer of type <b>DIM_INFORMATION_CONTAINER</b>.
<b>DIM_INFORMATION_CONTAINER.dwBufferSize</b> SHOULD be initialized to zero
(0). Upon successful return, the <b>pInfoStruct-&gt;pBuffer</b> is typecast to <b>MPR_SERVER_0</b>,
<b>MPR_SERVER_1</b>,<a id="Appendix_A_Target_251"></a><a aria-label="Product behavior note 251" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_251" data-linktype="relative-path">&lt;251&gt;</a> or <b>MPR_SERVER_2</b><a id="Appendix_A_Target_252"></a><a aria-label="Product behavior note 252" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_252" data-linktype="relative-path">&lt;252&gt;</a> based on the <i>dwLevel</i>
value.</p><p><b>Return Values: </b>A 32-bit, unsigned integer
value that indicates return status. A return value of ERROR_SUCCESS
(0x00000000) indicates that the operation was completed successfully;
otherwise, the return value contains an error code, as specified in <a href="../ms-erref/1bc92ddf-b79e-413c-bbaa-99a5281a6c90" data-linktype="relative-path">[MS-ERREF]</a>
or in section <a href="5c0c991a-0d3d-4fe5-9503-5128d0d49fe1" data-linktype="relative-path">2.2.4</a>.
All values not in the table that follows MUST be treated the same by the RRASM
client.</p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Return value/code</p>
   </th>
   <th>
   <p>Description</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>ERROR_SUCCESS</p>
  <p>0x00000000</p>
  </td>
  <td>
  <p>The call was successful.</p>
  </td>
 </tr><tr>
  <td>
  <p>ERROR_ACCESS_DENIED</p>
  <p>0x00000005</p>
  </td>
  <td>
  <p>The calling application does not have sufficient
  privileges as specified in section <a href="9373431f-ed29-4639-9f8b-743267c9f9b6" data-linktype="relative-path">2.1.1.1</a>.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p>The opnum field value for this method is 0.</p><p>When processing this call, the RRASM server MUST do the
following:</p><ul><li><p><span><span> 
</span></span>Validate, as specified in section 2.1.1.1, whether this method
was called by a <a href="fc2dfae9-0d04-4e1d-97c9-c51c2dc06c3b#gt_60e0e1fa-66fe-41e1-b5e3-ceab97e53506" data-linktype="relative-path">client</a>
that has access to the method. If the client does not have access, then return
error ERROR_ACCESS_DENIED (0x00000005).</p>
</li><li><p><span><span> 
</span></span>If <i>pInfoStruct</i> is NULL, return an error other than those
specified in the previous table.</p>
</li><li><p><span><span> 
</span></span>If <i>dwLevel</i> is not supported, return an error other than
one of the errors specified in the preceding table.</p>
</li><li><p><span><span> 
</span></span>Call the abstract interface <b>Invoke DIMSVC </b>method
specifying the operation and the parameters to enable RRAS server to perform
the required management task.</p>
</li><li><p><span><span> 
</span></span>If the RRAS server processes the request successfully, populate <i>pInfoStruct</i>
with the information returned by the RRAS server. Return ERROR_SUCCESS
(0x00000000).</p>
</li><li><p><span><span> 
</span></span>Otherwise return the error provided by the RRAS server.</p>
</li></ul><p>No exceptions are thrown beyond those thrown by the
underlying RPC protocol <a href="../ms-rpce/290c38b1-92fe-4229-91e6-4fc376610c15" data-linktype="relative-path">[MS-RPCE]</a>.</p></div>