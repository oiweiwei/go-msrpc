<div class="content"><p>The <b>RMIBGetTrapInfo</b> method<a id="Appendix_A_Target_299"></a><a aria-label="Product behavior note 299" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_299" data-linktype="relative-path">&lt;299&gt;</a> queries the module that set a
trap event for more information about the trap. This method cannot be called
remotely.</p><dl>
<dd>
<div><pre> DWORD RMIBGetTrapInfo(
   [in] DIM_HANDLE hDimServer,
   [in] DWORD dwPid,
   [in] DWORD dwRoutingPid,
   [in, out] PDIM_MIB_ENTRY_CONTAINER pInfoStruct
 );
</pre></div>
</dd></dl><p><b>hDimServer: </b>A handle to the RRASM server where
the call is to be executed, see section <a href="1f8cdbcc-9791-4a35-ad78-878b8d110e15" data-linktype="relative-path">3.1.3</a>.</p><p><b>dwPid: </b>Specifies the transport protocol. The
value of this parameter MUST be one from the following table.<a id="Appendix_A_Target_300"></a><a aria-label="Product behavior note 300" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_300" data-linktype="relative-path">&lt;300&gt;</a></p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Value</p>
   </th>
   <th>
   <p>Meaning</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>PID_IPX</p>
  <p>0x0000002B</p>
  </td>
  <td>
  <p>An IPX MIB entry is to be retrieved.</p>
  </td>
 </tr><tr>
  <td>
  <p>PID_IP</p>
  <p>0x00000021</p>
  </td>
  <td>
  <p>An IPv4 MIB entry is to be retrieved.</p>
  </td>
 </tr><tr>
  <td>
  <p>PID_IPV6</p>
  <p>0x00000057</p>
  </td>
  <td>
  <p>An IPv6 entry is to be retrieved.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p><b>dwRoutingPid: </b>Specifies the routing protocol
that exported the variable.</p><p><b>pInfoStruct: </b>Pointer to an opaque data
structure <a href="4305d67f-9273-49fe-a067-909b6ae8a341" data-linktype="relative-path"><b>DIM_MIB_ENTRY_CONTAINER (section 2.2.1.2.19)</b></a>.
The data structure&#39;s format is determined by the router manager or router
manager client that is servicing the call. The data structure MUST contain
information that specifies the variable being created and the value to assign
to the variable.   </p><p><b>Return Values: </b>A 32-bit, unsigned integer
value that indicates return status. A return value of ERROR_SUCCESS
(0x00000000) indicates that the operation was completed successfully;
otherwise, the value contains an error code, as specified in <a href="../ms-erref/1bc92ddf-b79e-413c-bbaa-99a5281a6c90" data-linktype="relative-path">[MS-ERREF]</a>
or in section <a href="5c0c991a-0d3d-4fe5-9503-5128d0d49fe1" data-linktype="relative-path">2.2.4</a>.
All values that are not in the table that follows MUST be treated the same by
the RRASM client.</p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Return value/code</p>
   </th>
   <th>
   <p>Description</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>ERROR_SUCCESS</p>
  <p>0x00000000</p>
  </td>
  <td>
  <p>The call was successful.</p>
  </td>
 </tr><tr>
  <td>
  <p>ERROR_ACCESS_DENIED</p>
  <p>0x00000005</p>
  </td>
  <td>
  <p>The calling application does not have sufficient
  privileges.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p>The opnum field value for this method is 32.</p><p>When processing this call, the RRASM server MUST do the
following:</p><ul><li><p><span><span> 
</span></span>Validate, as specified in section <a href="9373431f-ed29-4639-9f8b-743267c9f9b6" data-linktype="relative-path">2.1.1.1</a>, whether this
method was called by a client that has access to the method. If not, then
return error ERROR_ACCESS_DENIED.</p>
</li><li><p><span><span> 
</span></span>If <i>pInfoStruct</i> is NULL, return an error other than one of
the errors specified in the preceding table.</p>
</li><li><p><span><span> 
</span></span>If <i>dwPid</i> is not specified in the <b>SupportedTransportsList</b>,
return an error other than those specified in the preceding table.</p>
</li><li><p><span><span> 
</span></span>Call the abstract interface <b>Invoke DIMSVC</b> method
specifying the operation and the parameters to enable RRAS server to perform
the required management task.</p>
</li><li><p><span><span> 
</span></span>If the RRAS server successfully processes the request, return the
information in pInfoStruct and with the information provided by the RRAS server
and return ERROR_SUCCESS (0x00000000). Otherwise return the error result
provided by the RRAS server.</p>
</li></ul><p> No exceptions are thrown beyond those thrown by the
underlying RPC protocol <a href="../ms-rpce/290c38b1-92fe-4229-91e6-4fc376610c15" data-linktype="relative-path">[MS-RPCE]</a>.</p></div>