<div class="content"><p>The <b>RRasAdminConnectionGetInfoEx</b> method<a id="Appendix_A_Target_321"></a><a aria-label="Product behavior note 321" href="3bb906f0-b077-47ab-ad11-d8d807afde26#Appendix_A_321" data-linktype="relative-path">&lt;321&gt;</a> retrieves the connection
information for a specific connection given in <i>hDimConnection</i> for a
specified RRAS server using handle <i>hDimServer</i>. The caller SHOULD free
the memory pointed to by <i>pRasConnection</i>.</p><dl>
<dd>
<div><pre> DWORD RRasAdminConnectionGetInfoEx(
   [in] DIM_HANDLE hDimServer,
   [in] DWORD hDimConnection,
   [in] PMPRAPI_OBJECT_HEADER_IDL objectHeader,
   [out] PRAS_CONNECTION_EX_IDL pRasConnection
 );
</pre></div>
</dd></dl><p><b>hDimServer: </b>A handle to the RRASM server where
the call is to be executed, see section <a href="1f8cdbcc-9791-4a35-ad78-878b8d110e15" data-linktype="relative-path">3.1.3</a>.</p><p><b>hDimConnection: </b>This is of type <a href="../ms-dtyp/262627d8-3418-4627-9218-4ffe110850b2" data-linktype="relative-path">DWORD</a>
and MUST be set to a particular connection identifier for which the connection
information is required. Obtain this handle by calling <a href="d1261e41-c4cf-4a11-8eba-9f161f33dcb9" data-linktype="relative-path"><b>RRasAdminConnectionEnumEx (section 3.1.4.46)</b></a>.
Because the RRASM server does not maintain the connection handles, the RRAS
server SHOULD check and ensure that this handle represents a valid connection
handle.</p><p><b>objectHeader: </b>A pointer to <a href="abab767e-8f43-40c6-bb13-ff65307f05ef" data-linktype="relative-path"><b>MPRAPI_OBJECT_HEADER_IDL (section 2.2.1.2.129)</b></a>.
In the structure, the <b>revision</b> field MUST be
MPRAPI_RAS_CONNECTION_OBJECT_REVISION_1, the <b>type</b> field MUST be
MPRAPI_OBJECT_TYPE_RAS_CONNECTION_OBJECT, and the <b>size</b> MUST be the size
of RAS_CONNECTION_EX_IDL. </p><p><b>pRasConnection: </b>Upon successful return, this
is a pointer to a <a href="244bfb40-58d4-416f-a883-382e763fe609" data-linktype="relative-path"><b>RAS_CONNECTION_EX_IDL (section 2.2.1.2.134)</b></a>
structure. </p><p><b>Return Values: </b>A 32-bit unsigned integer value
that indicates return status. A return value of ERROR_SUCCESS (0x00000000)
indicates that the operation was completed successfully; otherwise, it contains
an error code, as specified in <a href="../ms-erref/1bc92ddf-b79e-413c-bbaa-99a5281a6c90" data-linktype="relative-path">[MS-ERREF]</a>
or in section <a href="5c0c991a-0d3d-4fe5-9503-5128d0d49fe1" data-linktype="relative-path">2.2.4</a>.
All values that are not in the table that follows MUST be treated the same by
the RRASM client. </p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Return value/code</p>
   </th>
   <th>
   <p>Description</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>ERROR_SUCCESS</p>
  <p>0x00000000</p>
  </td>
  <td>
  <p>The call was successful.</p>
  </td>
 </tr><tr>
  <td>
  <p>ERROR_ACCESS_DENIED</p>
  <p>0x00000005</p>
  </td>
  <td>
  <p>The calling application does not have sufficient
  privileges, as specified in section <a href="9373431f-ed29-4639-9f8b-743267c9f9b6" data-linktype="relative-path">2.1.1.1</a>.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p>The opnum field value for this method is 46.</p><p>When processing this call, the RRASM server MUST do the
following:</p><ul><li><p><span><span> 
</span></span>Validate, as specified in section 2.1.1.1, whether this method
was called by a client that has access to the method. If the client does not
have access, then return error ERROR_ACCESS_DENIED (0x00000005).</p>
</li><li><p><span><span> 
</span></span>If <i>RouterType</i> is ROUTER_TYPE_LAN, return an error other
than those in the preceding table.</p>
</li><li><p><span><span> 
</span></span>Call the abstract interface <b>Invoke DIMSVC</b> method
specifying the operation and the parameters to enable RRAS server to perform
the required management task.</p>
</li><li><p><span><span> 
</span></span>If the RRAS server successfully processes the request, populate <i>pRasConnection</i>
with information specific to the connection that was requested in <i>hDimConnection</i>.
Return ERROR_SUCCESS to the caller. If the RRAS server doesn’t complete the
request successfully, return the error status returned.</p>
</li></ul><p>No exceptions are thrown beyond those thrown by the
underlying RPC protocol <a href="../ms-rpce/290c38b1-92fe-4229-91e6-4fc376610c15" data-linktype="relative-path">[MS-RPCE]</a>.</p></div>